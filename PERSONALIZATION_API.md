# üìù API –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —É—Ä–æ–∫–æ–≤

## –û–±–∑–æ—Ä

API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è, –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π —É—Ä–æ–∫–æ–≤ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## Endpoints

### 1. –°–æ–∑–¥–∞–Ω–∏–µ/–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

**POST** `/api/personalizations`

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é —É—Ä–æ–∫–∞ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª—è.

#### Request Body

```json
{
  "profileId": "uuid",
  "lessonId": "uuid",
  "content": {
    "introduction": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —É—Ä–æ–∫...",
    "key_points": ["–ü—É–Ω–∫—Ç 1", "–ü—É–Ω–∫—Ç 2", "–ü—É–Ω–∫—Ç 3"],
    "homework": "–í—ã–ø–æ–ª–Ω–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è...",
    "custom_field": "–õ—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ"
  }
}
```

#### Response (Success)

```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "profile_id": "uuid",
    "lesson_id": "uuid",
    "content": { ... },
    "created_at": "2025-10-13T10:00:00Z"
  },
  "message": "–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞"
}
```

#### Response (Error)

```json
{
  "error": "Missing required fields: profileId, lessonId, content"
}
```

### 2. –£–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

**DELETE** `/api/personalizations`

–£–¥–∞–ª—è–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —É—Ä–æ–∫–∞.

#### Request Body

```json
{
  "profileId": "uuid",
  "lessonId": "uuid"
}
```

#### Response (Success)

```json
{
  "success": true,
  "message": "–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–∞"
}
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### JavaScript/TypeScript

```typescript
// –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
async function createPersonalization(profileId: string, lessonId: string, content: object) {
  const response = await fetch('/api/personalizations', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify({
      profileId,
      lessonId,
      content,
    }),
  });
  
  return await response.json();
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
const result = await createPersonalization(
  'a954c858-888d-4e68-b1cd-5d0b2943d207',
  '123e4567-e89b-12d3-a456-426614174000',
  {
    introduction: '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –≠—Ç–æ—Ç —É—Ä–æ–∫ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤–∞—Å.',
    key_points: [
      '–£—á–∏—Ç—ã–≤–∞—è –≤–∞—à—É –ø—Ä–æ—Ñ–µ—Å—Å–∏—é, –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞...',
      '–° —É—á–µ—Ç–æ–º –≤–∞—à–µ–≥–æ –æ–ø—ã—Ç–∞, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º...',
    ],
    homework: '–í—ã–ø–æ–ª–Ω–∏—Ç–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥—Ö–æ–¥—è—Ç –∏–º–µ–Ω–Ω–æ –≤–∞–º.',
  }
);
```

### cURL

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
curl -X POST https://pesonalisev2-zxby.vercel.app/api/personalizations \
  -H "Content-Type: application/json" \
  -d '{
    "profileId": "a954c858-888d-4e68-b1cd-5d0b2943d207",
    "lessonId": "123e4567-e89b-12d3-a456-426614174000",
    "content": {
      "introduction": "–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –≤–≤–µ–¥–µ–Ω–∏–µ",
      "key_points": ["–ü—É–Ω–∫—Ç 1", "–ü—É–Ω–∫—Ç 2"]
    }
  }'

# –£–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
curl -X DELETE https://pesonalisev2-zxby.vercel.app/api/personalizations \
  -H "Content-Type: application/json" \
  -d '{
    "profileId": "a954c858-888d-4e68-b1cd-5d0b2943d207",
    "lessonId": "123e4567-e89b-12d3-a456-426614174000"
  }'
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### Profile (–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

```typescript
interface Profile {
  id: string;
  user_identifier: string;
  name: string | null;
  course_slug: string | null;
  survey: {
    age?: number;
    profession?: string;
    experience?: string;
    goals?: string[];
    [key: string]: unknown;
  } | null;
  created_at: string;
}
```

### Personalized Lesson Description

```typescript
interface PersonalizedLessonDescription {
  id: string;
  profile_id: string;
  lesson_id: string;
  content: {
    // –õ—é–±–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
    introduction?: string;
    key_points?: string[];
    homework?: string;
    video_notes?: string;
    [key: string]: unknown;
  };
  created_at: string;
}
```

## UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–Ω–∫–µ—Ç—ã –ø—Ä–æ—Ñ–∏–ª—è

```tsx
import { ProfileSurvey } from '@/components/profiles/profile-survey';

<ProfileSurvey 
  survey={profile.survey} 
  profileName={profile.name}
/>
```

### 2. –†–µ–¥–∞–∫—Ç–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏

```tsx
import { PersonalizationEditor } from '@/components/personalizations/personalization-editor';

<PersonalizationEditor
  profileId="uuid"
  lessonId="uuid"
  lessonTitle="–£—Ä–æ–∫ 1: –í–≤–µ–¥–µ–Ω–∏–µ"
  initialContent={existingContent}
  onSave={() => console.log('Saved!')}
/>
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ UI

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ Dashboard**: https://pesonalisev2-zxby.vercel.app/dashboard
2. **–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ—Ñ–∏–ª—å** –≤ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏
3. **–ù–∞–∂–º–∏—Ç–µ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–µ–π ‚Üí"** –ø–æ–¥ –ø—Ä–æ—Ñ–∏–ª–µ–º
4. **–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ JSON** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–∫–∞
5. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è**

## –ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```json
{
  "greeting": "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –ê–ª–µ–∫—Å–µ–π!",
  "intro": "–° —É—á–µ—Ç–æ–º –≤–∞—à–µ–≥–æ –æ–ø—ã—Ç–∞ –≤ –º–∞—Å—Å–∞–∂–µ, —ç—Ç–æ—Ç —É—Ä–æ–∫ –±—É–¥–µ—Ç –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–µ–Ω.",
  "tips": [
    "–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã–º–∏ —Ç–æ—á–∫–∞–º–∏",
    "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–Ω–∞–Ω–∏—è –∞–Ω–∞—Ç–æ–º–∏–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è"
  ]
}
```

### –ü—Ä–∏–º–µ—Ä 2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```json
{
  "introduction": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ —É—Ä–æ–∫ –ø–æ—Å—Ç–∏–∑–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π —Ä–µ–ª–∞–∫—Å–∞—Ü–∏–∏!",
  "personalized_notes": {
    "based_on_experience": "–í—ã —É–∫–∞–∑–∞–ª–∏, —á—Ç–æ –∏–º–µ–µ—Ç–µ –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏. –≠—Ç–æ—Ç —É—Ä–æ–∫ –ø–æ–º–æ–∂–µ—Ç —Å–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–∏ –∑–Ω–∞–Ω–∏—è.",
    "based_on_goals": "–í–∞—à–∞ —Ü–µ–ª—å - –æ—Å–≤–æ–∏—Ç—å —Ç–µ—Ö–Ω–∏–∫—É –®–í–ó. –ú—ã –Ω–∞—á–Ω–µ–º —Å –æ—Å–Ω–æ–≤."
  },
  "key_concepts": [
    "–ü–æ–Ω—è—Ç–∏–µ –ø–æ—Å—Ç–∏–∑–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–π —Ä–µ–ª–∞–∫—Å–∞—Ü–∏–∏",
    "–ú–µ—Ö–∞–Ω–∏–∑–º –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –º—ã—à–µ—á–Ω—ã–µ –≤–æ–ª–æ–∫–Ω–∞",
    "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ"
  ],
  "homework": {
    "theory": "–ò–∑—É—á–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ –∞–Ω–∞—Ç–æ–º–∏–∏",
    "practice": "–ü–æ–ø—Ä–∞–∫—Ç–∏–∫—É–π—Ç–µ—Å—å –Ω–∞ –¥–æ–±—Ä–æ–≤–æ–ª—å—Ü–µ 10-15 –º–∏–Ω—É—Ç"
  },
  "next_steps": "–í —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–∫–µ –º—ã –ø–µ—Ä–µ–π–¥–µ–º –∫ —Ç—Ä–∏–≥–≥–µ—Ä–Ω—ã–º —Ç–æ—á–∫–∞–º"
}
```

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ JSON** –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏** (introduction, key_points, homework)
3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ** –ª–æ–≥–∏—á–µ—Å–∫–∏
4. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç** –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∫–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏** –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `personalized_lesson_descriptions`:

- `id` - UUID –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏
- `profile_id` - UUID –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `lesson_id` - UUID —É—Ä–æ–∫–∞
- `content` - JSON —Å –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- `created_at` - –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è

**–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å**: `(profile_id, lesson_id)` - –æ–¥–∏–Ω –ø—Ä–æ—Ñ–∏–ª—å –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω—É –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞ —É—Ä–æ–∫.


