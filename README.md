# Persona Platform (Next.js 15 + Supabase)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–µ—Ä–µ–≤–µ–¥—ë–Ω –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–µ–∫:

- **Next.js 15 (App Router)** + **React 19**
- **Tailwind CSS v4**, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã **shadcn/ui**
- **Supabase** (Postgres, Auth, Storage)
- **Vitest** + **Testing Library** –¥–ª—è unit-—Ç–µ—Å—Ç–æ–≤, **Playwright** + **MSW** –¥–ª—è E2E
- **pnpm** ‚Äî –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∏ lockfile

–í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å—Ç–∞—Ä–æ–π PHP-–≤–µ—Ä—Å–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `trash/` (–∏—Å–∫–ª—é—á—ë–Ω –∏–∑ git, –Ω–æ –æ—Å—Ç–∞—ë—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ).

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
pnpm install
pnpm dev --port 3210
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ dev-—Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:3210/dashboard`.

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`webapp/.env`)

```ini
NEXT_PUBLIC_SUPABASE_URL=https://guzeszmhrfalbvamzxgg.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=<anon key>
SUPABASE_SERVICE_ROLE_KEY=<service role key>
SUPABASE_DB_URL=postgresql://postgres:<password>@db.guzeszmhrfalbvamzxgg.supabase.co:5432/postgres
OPENAI_API_KEY=<–∫–ª—é—á OpenAI>
COURSE_STORE_PATH=../store/–ú–∞—Å—Å–∞–∂ –®–í–ó
```

## –ö–æ–º–∞–Ω–¥—ã

| –°–∫—Ä–∏–ø—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| --- | --- |
| `pnpm dev --port 3210` | dev-—Å–µ—Ä–≤–µ—Ä Next.js |
| `pnpm db:migrate` | –ø—Ä–∏–º–µ–Ω–∏—Ç—å SQL-–º–∏–≥—Ä–∞—Ü–∏–∏ –∫ Supabase |
| `pnpm db:seed` | –∏–º–ø–æ—Ä—Ç —É—Ä–æ–∫–æ–≤, –ø—Ä–æ—Ñ–∏–ª–µ–π –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–π |
| `pnpm test` | unit + env —Ç–µ—Å—Ç—ã (Vitest) |
| `pnpm exec playwright test` | E2E Smoke (Playwright) |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

- `webapp/` ‚Äî –Ω–æ–≤–∞—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥/–±—ç–∫–µ–Ω–¥-–∑–æ–Ω–∞ –Ω–∞ Next.js
- `webapp/app/(dashboard)/dashboard` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π UI —É—Ä–æ–∫–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–π
- `webapp/scripts/` ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Supabase
- `trash/` ‚Äî –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ PHP-—Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏

## CI / –ü—Ä–æ–≤–µ—Ä–∫–∏

- `pnpm test`
- `pnpm exec playwright test`

## Git

–û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞: `main`. –ü–µ—Ä–µ–¥ –ø—É—à–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ –≤—Å—ë –∑–µ–ª—ë–Ω–æ–µ (`git status`, —Ç–µ—Å—Ç—ã). –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –≤–µ—Ç–∫–∏/PR.
# Persona Platform (Next.js 15 + Supabase)

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–µ—Ä–µ–≤–µ–¥—ë–Ω –Ω–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å—Ç–µ–∫:

- **Next.js 15 (App Router)** + **React 19**
- **Tailwind CSS v4**, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã **shadcn/ui**
- **Supabase** (Postgres, Auth, Storage)
- **Vitest** + **Testing Library** –¥–ª—è unit-—Ç–µ—Å—Ç–æ–≤, **Playwright** + **MSW** –¥–ª—è E2E
- **pnpm** ‚Äî –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –∏ lockfile

–í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å—Ç–∞—Ä–æ–π PHP-–≤–µ—Ä—Å–∏–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `trash/` (–∏—Å–∫–ª—é—á—ë–Ω –∏–∑ git, –Ω–æ –æ—Å—Ç–∞—ë—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ).

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
pnpm install
pnpm dev --port 3210
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ dev-—Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:3210/dashboard`.

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`webapp/.env`)

```ini
NEXT_PUBLIC_SUPABASE_URL=https://guzeszmhrfalbvamzxgg.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=<anon key>
SUPABASE_SERVICE_ROLE_KEY=<service role key>
SUPABASE_DB_URL=postgresql://postgres:<password>@db.guzeszmhrfalbvamzxgg.supabase.co:5432/postgres
OPENAI_API_KEY=<–∫–ª—é—á OpenAI>
COURSE_STORE_PATH=../store/–ú–∞—Å—Å–∞–∂ –®–í–ó
```

## –ö–æ–º–∞–Ω–¥—ã

| –°–∫—Ä–∏–ø—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| --- | --- |
| `pnpm dev --port 3210` | dev-—Å–µ—Ä–≤–µ—Ä Next.js (Webpack) |
| `pnpm db:migrate` | –ø—Ä–∏–º–µ–Ω–∏—Ç—å SQL-–º–∏–≥—Ä–∞—Ü–∏–∏ –∫ Supabase |
| `pnpm db:seed` | –∏–º–ø–æ—Ä—Ç —É—Ä–æ–∫–æ–≤, –ø—Ä–æ—Ñ–∏–ª–µ–π –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–π |
| `pnpm test` | unit + env —Ç–µ—Å—Ç—ã (Vitest) |
| `pnpm exec playwright test` | E2E Smoke (Playwright) |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞

- `webapp/` ‚Äî –Ω–æ–≤–∞—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥/–±—ç–∫–µ–Ω–¥-–∑–æ–Ω–∞ –Ω–∞ Next.js
- `webapp/app/(dashboard)/dashboard` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Ä–æ–∫–æ–≤ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–π
- `webapp/scripts/` ‚Äî –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ Supabase
- `trash/` ‚Äî –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ PHP-—Å–∫—Ä–∏–ø—Ç—ã –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏

## CI / –ü—Ä–æ–≤–µ—Ä–∫–∏

- `pnpm test`
- `pnpm exec playwright test`

## Git

–û—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞: `main`. –ü–µ—Ä–µ–¥ –ø—É—à–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ –≤—Å—ë –∑–µ–ª—ë–Ω–æ–µ (`git status`, —Ç–µ—Å—Ç—ã). –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ç–µ–º—É-–ø—É–ª—Ä–µ–∫–≤–µ—Å—Ç—ã.
# –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –∫—É—Ä—Å–æ–≤

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ —Å Kinescope, —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–∏–π —É—Ä–æ–∫–æ–≤ –∏ –∏—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ** —Å Kinescope –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö (360p, 720p, 1080p)
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ** –∏–∑ –≤–∏–¥–µ–æ —Ñ–∞–π–ª–æ–≤
- **–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è** –∞—É–¥–∏–æ —Å –ø–æ–º–æ—â—å—é OpenAI Whisper
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏–π** —É—Ä–æ–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é GPT-4o-mini
- **–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è** –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–¥ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è –∞–Ω–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
persona/
‚îú‚îÄ‚îÄ config.php                          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API –∫–ª—é—á–µ–π
‚îú‚îÄ‚îÄ utils.php                           # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ kinescope_api.php                   # API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Kinescope
‚îú‚îÄ‚îÄ whisper_api.php                     # API –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Whisper
‚îú‚îÄ‚îÄ queue_system.php                    # –°–∏—Å—Ç–µ–º–∞ –æ—á–µ—Ä–µ–¥–µ–π
‚îú‚îÄ‚îÄ process_video.php                   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ
‚îú‚îÄ‚îÄ process_course.php                  # –ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫—É—Ä—Å–∞
‚îú‚îÄ‚îÄ personalize_course.php              # –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∫—É—Ä—Å–∞
‚îú‚îÄ‚îÄ process_survey.php                  # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–Ω–∫–µ—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ view_lesson.php                     # –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞
‚îú‚îÄ‚îÄ view_homework.php                   # –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
‚îú‚îÄ‚îÄ view_personalized_course.php        # –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫—É—Ä—Å–∞
‚îú‚îÄ‚îÄ store/                              # –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ {course_name}/                  # –ü–∞–ø–∫–∞ –∫—É—Ä—Å–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {lesson}-{video_id}.txt     # –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ {lesson}-{video_id}-final.json # –û–ø–∏—Å–∞–Ω–∏—è —É—Ä–æ–∫–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ personalize/                # –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ {user_id}/              # –ü–∞–ø–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ {lesson}-{video_id}-{user_id}.json
‚îÇ   ‚îî‚îÄ‚îÄ user_profiles.json              # –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îî‚îÄ‚îÄ trash/                              # –£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```

## üõ†Ô∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
   ```bash
   # PHP —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏: curl, json, mbstring
   # FFmpeg –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ/–∞—É–¥–∏–æ
   brew install ffmpeg
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ API –∫–ª—é—á–∏ –≤ `config.php`:**
   ```php
   return [
       'apis' => [
           'kinescope' => [
               'api_key' => 'YOUR_KINESCOPE_API_KEY'
           ],
           'openai' => [
               'api_key' => 'YOUR_OPENAI_API_KEY'
           ]
       ]
   ];
   ```

3. **–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫–∏:**
   ```bash
   mkdir -p store
   chmod 755 store
   ```

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ

```bash
php process_video.php --url=https://kinescope.io/VIDEO_ID --lesson=1 --course="–ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞" --quality=360p
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
php process_video.php --url=https://kinescope.io/202339654 --lesson=1 --course="–ú–∞—Å—Å–∞–∂ –®–í–ó" --quality=360p
```

### 2. –ú–∞—Å—Å–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫—É—Ä—Å–∞

–°–æ–∑–¥–∞–π—Ç–µ JSON —Ñ–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º –≤–∏–¥–µ–æ:

```json
[
  {
    "url": "https://kinescope.io/VIDEO_ID_1",
    "lesson": 1,
    "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞ 1"
  },
  {
    "url": "https://kinescope.io/VIDEO_ID_2", 
    "lesson": 2,
    "title": "–ù–∞–∑–≤–∞–Ω–∏–µ —É—Ä–æ–∫–∞ 2"
  }
]
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É:

```bash
php process_course.php --course="–ù–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞" --videos=videos.json --quality=360p
```

### 3. –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∫—É—Ä—Å–∞

```bash
php personalize_course.php --user=user_1234567890_abc12344 --course="–ú–∞—Å—Å–∞–∂ –®–í–ó"
```

### 4. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä:

```bash
php -S localhost:8000
```

**–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
- `http://localhost:8000/view_lesson.php?uid={user_id}&lesson={lesson}&course={course}` - –ü—Ä–æ—Å–º–æ—Ç—Ä —É—Ä–æ–∫–∞
- `http://localhost:8000/view_homework.php?uid={user_id}&lesson={lesson}&course={course}` - –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
- `http://localhost:8000/view_personalized_course.php?uid={user_id}&course={course}` - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ–≥–æ –∫—É—Ä—Å–∞
- `http://localhost:8000/process_survey.php?uid={user_id}&course={course}` - –ê–Ω–∫–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üîß API –∏ —Ñ—É–Ω–∫—Ü–∏–∏

### KinescopeAPI

- `extractVideoId($url)` - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ ID –≤–∏–¥–µ–æ –∏–∑ URL
- `getVideoInfo($videoId)` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∏–¥–µ–æ
- `getVideoDownloadUrl($videoId, $quality)` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ
- `downloadVideoWithRetry($url, $file)` - –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≤–∏–¥–µ–æ —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏

### WhisperAPI

- `extractAudio($videoFile, $audioFile)` - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—É–¥–∏–æ –∏–∑ –≤–∏–¥–µ–æ
- `transcribe($audioFile)` - –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –∞—É–¥–∏–æ
- `compressAudio($audioFile)` - –°–∂–∞—Ç–∏–µ –∞—É–¥–∏–æ
- `splitAudio($audioFile)` - –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–ª–∏–Ω–Ω–æ–≥–æ –∞—É–¥–∏–æ –Ω–∞ —á–∞—Å—Ç–∏

### QueueSystem

- `addLessonToQueue($lessonData)` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Ä–æ–∫–∞ –≤ –æ—á–µ—Ä–µ–¥—å
- `getProcessingQueue()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `updateLessonStatus($lessonId, $status)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —É—Ä–æ–∫–∞

## üìä –§–æ—Ä–º–∞—Ç—ã –¥–∞–Ω–Ω—ã—Ö

### –û–ø–∏—Å–∞–Ω–∏–µ —É—Ä–æ–∫–∞ (JSON)

```json
{
  "summary_short": "–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞–≤—ã–∫–∞",
  "prev_lessons": "–°–≤—è–∑—å —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ —É—Ä–æ–∫–∞–º–∏",
  "why_watch": "–ü–æ–ª—å–∑–∞ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è (400-600 –∑–Ω–∞–∫–æ–≤)",
  "quick_action": "–ë—ã—Å—Ç—Ä–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (1-2 –º–∏–Ω—É—Ç—ã)",
  "social_share": "–¢–µ–∫—Å—Ç –¥–ª—è —Å–æ—Ü—Å–µ—Ç–µ–π",
  "homework_20m": "–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ (–¥–æ 20 –º–∏–Ω—É—Ç)"
}
```

### –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (JSON)

```json
{
  "name": "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "survey": {
    "experience": "none|self_taught|offline_courses|professional_education",
    "motivation": ["new_profession", "extra_income", "help_family", "health_interest"],
    "target_clients": "–û–ø–∏—Å–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–∏",
    "skills_wanted": "–ñ–µ–ª–∞–µ–º—ã–µ –Ω–∞–≤—ã–∫–∏",
    "fears": ["technique_fail", "not_enough_practice", "no_clients"],
    "wow_result": "–ñ–µ–ª–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
    "practice_model": "–ú–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏"
  }
}
```

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:
- –û—à–∏–±–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ (–ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏)
- –û—à–∏–±–∫–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏ (—Å–∂–∞—Ç–∏–µ –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∞—É–¥–∏–æ)
- –û—à–∏–±–∫–∏ API (—Ç–∞–π–º–∞—É—Ç—ã –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
- –û—à–∏–±–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ (–≤–∞–ª–∏–¥–∞—Ü–∏—è JSON)

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—á–µ—Ä–µ–¥–∏
php -r "require 'queue_system.php'; print_r(getProcessingQueue());"

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
php -r "require 'queue_system.php'; print_r(getQueueStats());"
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- API –∫–ª—é—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `config.php`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –ø–∞–ø–∫–µ `store/`
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìù –õ–æ–≥–∏

–°–∏—Å—Ç–µ–º–∞ –≤–µ–¥–µ—Ç –ª–æ–≥–∏ –≤:
- `store/processing_queue.json` - –û—á–µ—Ä–µ–¥—å –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `store/processing_status.json` - –°—Ç–∞—Ç—É—Å—ã —É—Ä–æ–∫–æ–≤
- `store/user_profiles.json` - –ü—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á–∏ –≤ `config.php`
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏ FFmpeg
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–µ `store/`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ `store/`












