# üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ —É—Ä–æ–∫–∞ –ø–æ course

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –∫–æ–¥–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Å–∞–π—Ç GetCourse –ø–æ–∫–∞–∑—ã–≤–∞–ª—Å—è **—É—Ä–æ–∫ –∏–∑ –¥—Ä—É–≥–æ–≥–æ –∫—É—Ä—Å–∞**.

### –ü—Ä–∏–º–µ—Ä:
```html
<!-- –£—Ä–æ–∫ 2 –∫—É—Ä—Å–∞ "–ú–∞—Å—Å–∞–∂ –®–í–ó" -->
<div data-course="shvz" data-lesson="2">
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–∫–∞–∑—ã–≤–∞–ª—Å—è —É—Ä–æ–∫ "+1.–¢–µ–π–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ—Ä—â–∏–Ω –Ω–∞ –ª–±—É" –∏–∑ –∫—É—Ä—Å–∞ Kinesio 2 ‚ùå

## –ü—Ä–∏—á–∏–Ω—ã

1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π slug –∫—É—Ä—Å–∞ –≤ HTML**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è: `data-course="shvz"`
   - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π slug: `data-course="massazh-shvz"`

2. **API –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª profile.course_slug**
   - –ö–æ–¥ –ø—ã—Ç–∞–ª—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `profile.course_id` (–∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ)
   - –î–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `profile.course_slug` –∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –µ–≥–æ –≤ course_id

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–æ–¥–µ

### –§–∞–π–ª: `/app/api/persona/block/route.ts`

**–ë—ã–ª–æ:**
```typescript
// –ï—Å–ª–∏ course –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º course_id –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è
if (!courseId && profile?.course_id) {
  courseId = profile.course_id;
  console.log('[/api/persona/block] Using course_id from profile:', courseId);
}
```

**–°—Ç–∞–ª–æ:**
```typescript
// –ï—Å–ª–∏ course –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω –∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º course_slug –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è
if (!courseId && profile?.course_slug) {
  console.log('[/api/persona/block] No course param, using profile.course_slug:', profile.course_slug);
  
  const { data: profileCourseData } = await supabase
    .from("courses")
    .select("id")
    .eq("slug", profile.course_slug)
    .maybeSingle();
  
  if (profileCourseData) {
    courseId = profileCourseData.id;
    console.log('[/api/persona/block] Using course_id from profile course_slug:', courseId);
  }
}
```

## –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ slugs –∫—É—Ä—Å–æ–≤

| –ö—É—Ä—Å | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π slug | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |
|------|----------------|-------------|
| –ú–∞—Å—Å–∞–∂ –®–í–ó | `massazh-shvz` | ~~shvz~~ |
| –ö–∏–Ω–µ–∑–∏–æ—Ç–µ–π–ø–∏—Ä–æ–≤–∞–Ω–∏–µ | `kinesio2` | ~~kinesio~~, ~~taping~~ |
| –û—Å–Ω–æ–≤—ã —Ç–µ–π–ø–∏—Ä–æ–≤–∞–Ω–∏—è | `taping-basics` | ~~taping~~, ~~basics~~ |

## –ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å–∞–π—Ç–µ

### –î–ª—è –∫—É—Ä—Å–∞ "–ú–∞—Å—Å–∞–∂ –®–í–ó":

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥:**
```html
<div id="persona-lesson-2" 
     data-lesson="2" 
     data-title="2. –¢–µ–æ—Ä–∏—è. –ú—ã—à—Ü—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —ç—Ç–æ–º –∫—É—Ä—Å–µ"
     data-course="massazh-shvz" 
     style="display:none;margin:30px 0;">
</div>
```

### –î–ª—è –∫—É—Ä—Å–∞ "–ö–∏–Ω–µ–∑–∏–æ—Ç–µ–π–ø–∏—Ä–æ–≤–∞–Ω–∏–µ":

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥:**
```html
<div id="persona-lesson-2" 
     data-lesson="2" 
     data-title="–¢–µ–π–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ—Ä—â–∏–Ω –Ω–∞ –ª–±—É"
     data-course="kinesio2" 
     style="display:none;margin:30px 0;">
</div>
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–ó–∞–¥–µ–ø–ª–æ–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
   ```bash
   git add app/api/persona/block/route.ts
   git commit -m "fix: use profile.course_slug instead of non-existent course_id"
   git push
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ Vercel:**
   - –ü–æ–¥–æ–∂–¥–∏—Ç–µ –¥–µ–ø–ª–æ—è (1-2 –º–∏–Ω—É—Ç—ã)
   - –û—Ç–∫—Ä–æ–π—Ç–µ —É—Ä–æ–∫ –Ω–∞ GetCourse
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —É—Ä–æ–∫

3. **–¢–µ—Å—Ç —á–µ—Ä–µ–∑ API:**
   ```bash
   npx tsx scripts/test-lesson-course-lookup.ts
   ```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ –£—Ä–æ–∫ 2 –∫—É—Ä—Å–∞ "–ú–∞—Å—Å–∞–∂ –®–í–ó" ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–®–í–ó –ú—ã—à—Ü—ã, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –±—É–¥–µ–º —Ä–∞–±–æ—Ç–∞—Ç—å"
‚úÖ –£—Ä–æ–∫ 2 –∫—É—Ä—Å–∞ "–ö–∏–Ω–µ–∑–∏–æ—Ç–µ–π–ø–∏—Ä–æ–≤–∞–Ω–∏–µ" ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "+1.–¢–µ–π–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ—Ä—â–∏–Ω –Ω–∞ –ª–±—É"

–ö–∞–∂–¥—ã–π –∫—É—Ä—Å —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–≤–æ–∏ —É—Ä–æ–∫–∏!
